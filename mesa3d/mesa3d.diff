diff -aur Mesa-6.5.1.orig/src/glx/x11/glxext.c Mesa-6.5.1/src/glx/x11/glxext.c
--- Mesa-6.5.1.orig/src/glx/x11/glxext.c	2006-08-29 23:45:28.000000000 +0200
+++ Mesa-6.5.1/src/glx/x11/glxext.c	2006-11-29 18:01:03.219605180 +0100
@@ -1016,11 +1016,11 @@
 	if (!_XReply(dpy, (xReply*) &reply, 0, False)) {
 	    /* Something is busted. Punt. */
 	    UnlockDisplay(dpy);
+	    SyncHandle();
 	    FreeScreenConfigs(priv);
 	    return GL_FALSE;
 	}
 
-	UnlockDisplay(dpy);
 	if (!reply.numVisuals) {
 	    /* This screen does not support GL rendering */
 	    UnlockDisplay(dpy);
