# Description: X Window System server
# URL: http://xorg.freedesktop.org
# Maintainer: Tilman Sauerbeck, tilman at crux dot nu
# Depends on: mesa3d, xorg-bdftopcf, xorg-mkfontdir, xorg-mkfontscale, xorg-xf86driproto, xorg-libxkbui, xorg-xcmiscproto, xorg-scrnsaverproto, xorg-bigreqsproto, xorg-libxevie, xorg-libxtst, xorg-libdmx, xorg-libxxf86misc, xorg-libxaw, xorg-libxvmc, xorg-libxi, xorg-libxres, xorg-libxcomposite, xorg-libxinerama, xorg-libxrandr, xorg-libxtrap, xorg-libxft, xorg-libxcursor, xorg-libxxf86dga

name=xorg-server
version=1.3.0.0
release=2
source=(http://xorg.freedesktop.org/releases/individual/xserver/$name-$version.tar.bz2 \
        http://dl.sourceforge.net/mesa3d/MesaLib-6.5.2.tar.bz2 \
        $name.diff)


build() {
	cd $name-$version

	patch -Np1 -i $SRC/$name.diff

	# fix man page suffixes
	sed -i -e '33891d' -e '33917d' configure

	./configure --prefix=/usr --enable-dri \
	            --with-mesa-source=$SRC/Mesa-6.5.2 \
	            --localstatedir=/var --mandir=/usr/man \
	            --with-xkb-output=/var/lib/xkb

	make
	make DESTDIR=$PKG install

	rm $PKG/usr/lib/X11/xserver/README
	rmdir $PKG/var/log
}
